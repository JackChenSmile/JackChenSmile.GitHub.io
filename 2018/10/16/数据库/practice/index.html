<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    <head>
    <meta charset="utf-8">
    <meta name="keywords" content=", hexo-theme-matery">
    <meta name="description" content="To be or not to be,this is a question.">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>微笑看你</title>
    <link rel="icon" type="image/png" href="/medias/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
</head>
</head>

<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="container">
            <div class="nav-wrapper">
                <div class="brand-logo">
                    <a href="/" class="waves-effect waves-light">
                        
                        <span class="logo-span">微笑看你</span>
                    </a>
                </div>
                <a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>历史记录</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li>
        <a id="toggleSearch" class="waves-effect waves-light">
            <i id="searchIcon" class="mdi-action-search"></i>
        </a>
    </li>

</ul>

<div class="side-nav" id="mobile-nav">
    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">微笑看你</div>
        <div class="logo-desc">
            
            To be or not to be,this is a question.
            
        </div>
    </div>
    <ul class="menu-list">
        
        <li>
            <a href="[object Object]" class="waves-effect waves-light">
				<i class="fa fa-link fa-lg fa-fw"></i>首页
			</a>
		</li>
		
        <li>
            <a href="[object Object]" class="waves-effect waves-light">
				<i class="fa fa-link fa-lg fa-fw"></i>标签
			</a>
		</li>
		
        <li>
            <a href="[object Object]" class="waves-effect waves-light">
				<i class="fa fa-link fa-lg fa-fw"></i>分类
			</a>
		</li>
		
        <li>
            <a href="[object Object]" class="waves-effect waves-light">
				<i class="fa fa-link fa-lg fa-fw"></i>历史记录
			</a>
		</li>
		
        <li>
            <a href="[object Object]" class="waves-effect waves-light">
				<i class="fa fa-link fa-lg fa-fw"></i>关于
			</a>
		</li>
		
	</ul>
    <div class="social-link">
        <a href="https://github.com/JackChenSmile" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub"
           data-position="top" data-delay="50">
            <i class="fa fa-github fa-lg"></i>
        </a>
        <a href="mailto:chenjiayin1990@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我"
           data-position="top" data-delay="50">
            <i class="fa fa-envelope fa-lg"></i>
        </a>
        <a href="#!" class="tooltipped" data-tooltip="QQ联系我：1963298993" data-position="top" data-delay="50">
            <i class="fa fa-qq fa-lg"></i>
        </a>
    </div>
</div>
            </div>
        </div>
		
		
        <style>
    .nav-transparent .github-corner {
        display: none !important;
    }
    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }
    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }
    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }
    .github-corner .octo-arm {
        animation: none;
    }
    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/JackChenSmile/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>
</header>



<div class="bg-cover post-cover" style="background-image: url('/medias/featureimages/5.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        practice
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="container content">

    
    <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            
            <div class="post-info">
                

                <span class="post-date">
                    <i class="fa fa-clock-o fa-fw"></i>2018-10-16
                </span>
            </div>
        </div>
        <hr>
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h3 id="practice1"><a href="#practice1" class="headerlink" title="practice1"></a>practice1</h3><h5 id="创建列表过程"><a href="#创建列表过程" class="headerlink" title="创建列表过程"></a>创建列表过程</h5><ul>
<li><p>创建SRS数据库</p>
<pre class=" language-mysql"><code class="language-mysql">drop database if exists SRS;
create database SRS default charset utf8 collate utf8_bin;
</code></pre>
</li>
<li><p>切换到SRS数据库</p>
<pre class=" language-mysql"><code class="language-mysql">use SRS;
</code></pre>
</li>
<li><p>创建学院表</p>
<pre class=" language-mysql"><code class="language-mysql">create table tb_college
(
collid int not null auto_increment comment '学院编号',
collname varchar(50) not null comment '学院名称',
collmaster varchar(20) not null comment '院长姓名',
collweb varchar(511) default '' comment '学院网站',
primary key (collid)
);
</code></pre>
</li>
<li><p>添加唯一约束</p>
<pre class=" language-mysql"><code class="language-mysql">alter table tb_college add constraint uni_college_collname unique (collname);
</code></pre>
</li>
<li><p>创建学生表</p>
<pre class=" language-mysql"><code class="language-mysql">create table tb_student
(
stuid int not null comment '学号',
sname varchar(20) not null comment '学生姓名',
gender bit default 1 comment '性别',
birth date not null comment '出生日期',
addr varchar(255) default '' comment '籍贯',
collid int not null comment '所属学院编号',
primary key (stuid)
);
</code></pre>
</li>
<li><p>添加外键约束</p>
<pre class=" language-mysql"><code class="language-mysql">- alter table tb_student add constraint fk_student_collid foreign key (collid) references tb_college (collid);
</code></pre>
</li>
<li><p>创建教师表</p>
<pre class=" language-mysql"><code class="language-mysql">create table tb_teacher
(
teaid int not null comment '教师工号',
tname varchar(20) not null comment '教师姓名',
title varchar(10) default '' comment '职称',
collid int not null comment '所属学院编号'
);
</code></pre>
</li>
<li><p>添加主键约束</p>
<pre class=" language-mysql"><code class="language-mysql">alter table tb_teacher add constraint pk_teacher primary key (teaid);
</code></pre>
</li>
<li><p>添加外键约束</p>
<pre class=" language-mysql"><code class="language-mysql">alter table tb_teacher add constraint fk_teacher_collid foreign key (collid) references tb_college (collid);
</code></pre>
</li>
<li><p>创建课程表</p>
<pre class=" language-mysql"><code class="language-mysql">create table tb_course
(
couid int not null comment '课程编号',
cname varchar(50) not null comment '课程名称',
credit tinyint not null comment '学分',
teaid int not null comment '教师工号',
primary key (couid)
);
</code></pre>
</li>
<li><p>添加外键约束</p>
<pre class=" language-mysql"><code class="language-mysql">alter table tb_course add constraint fk_course_tid foreign key (teaid) references tb_teacher (teaid);
</code></pre>
</li>
<li><p>创建学生选课表</p>
<pre class=" language-mysql"><code class="language-mysql">create table tb_score
(
scid int not null auto_increment comment '选课编号',
sid int not null comment '学号',
cid int not null comment '课程编号',
seldate date comment '选课时间日期',
mark decimal(4,1) comment '考试成绩',
primary key (scid)
);
</code></pre>
</li>
<li><p>添加外键约束</p>
<pre class=" language-mysql"><code class="language-mysql">alter table tb_score add constraint fk_score_sid foreign key (sid) references tb_student (stuid);
alter table tb_score add constraint fk_score_cid foreign key (cid) references tb_course (couid);

-- 添加唯一约束
alter table tb_score add constraint uni_score_sid_cid unique (sid, cid);

</code></pre>
</li>
<li><p>插入学院数据</p>
<pre class=" language-mysql"><code class="language-mysql">insert into tb_college (collname, collmaster, collweb) values 
('计算机学院', '左冷禅', 'http://www.abc.com'),
('外国语学院', '岳不群', 'http://www.xyz.com'),
('经济管理学院', '风清扬', 'http://www.foo.com');
</code></pre>
</li>
<li><p>插入学生数据</p>
<pre class=" language-mysql"><code class="language-mysql">insert into tb_student (stuid, sname, gender, birth, addr, collid) values
(1001, '杨逍', 1, '1990-3-4', '四川成都', 1),
(1002, '任我行', 1, '1992-2-2', '湖南长沙', 1),
(1033, '王语嫣', 0, '1989-12-3', '四川成都', 1),
(1572, '岳不群', 1, '1993-7-19', '陕西咸阳', 1),
(1378, '纪嫣然', 0, '1995-8-12', '四川绵阳', 1),
(1954, '林平之', 1, '1994-9-20', '福建莆田', 1),
(2035, '东方不败', 1, '1988-6-30', null, 2),
(3011, '林震南', 1, '1985-12-12', '福建莆田', 3),
(3755, '项少龙', 1, '1993-1-25', null, 3),
(3923, '杨不悔', 0, '1985-4-17', '四川成都', 3);
</code></pre>
</li>
<li><p>插入老师数据</p>
<pre class=" language-mysql"><code class="language-mysql">insert into tb_teacher (teaid, tname, title, collid) values 
(1122, '张三丰', '教授', 1),
(1133, '宋远桥', '副教授', 1),
(1144, '杨逍', '副教授', 1),
(2255, '范遥', '副教授', 2),
(3366, '韦一笑', '讲师', 3);
</code></pre>
</li>
<li><p>插入课程数据</p>
<pre class=" language-mysql"><code class="language-mysql">insert into tb_course (couid, cname, credit, teaid) values 
(1111, 'Python程序设计', 3, 1122),
(2222, 'Web前端开发', 2, 1122),
(3333, '操作系统', 4, 1122),
(4444, '计算机网络', 2, 1133),
(5555, '编译原理', 4, 1144),
(6666, '算法和数据结构', 3, 1144),
(7777, '经贸法语', 3, 2255),
(8888, '成本会计', 2, 3366),
(9999, '审计学', 3, 3366);
</code></pre>
</li>
<li><p>插入选课数据</p>
<pre class=" language-mysql"><code class="language-mysql">insert into tb_score (sid, cid, seldate, mark) values 
(1001, 1111, '2017-09-01', 95),
(1001, 2222, '2017-09-01', 87.5),
(1001, 3333, '2017-09-01', 100),
(1001, 4444, '2018-09-03', null),
(1001, 6666, '2017-09-02', 100),
(1002, 1111, '2017-09-03', 65),
(1002, 5555, '2017-09-01', 42),
(1033, 1111, '2017-09-03', 92.5),
(1033, 4444, '2017-09-01', 78),
(1033, 5555, '2017-09-01', 82.5),
(1572, 1111, '2017-09-02', 78),
(1378, 1111, '2017-09-05', 82),
(1378, 7777, '2017-09-02', 65.5),
(2035, 7777, '2018-09-03', 88),
(2035, 9999, date(now()), null),
(3755, 1111, date(now()), null),
(3755, 8888, date(now()), null),
(3755, 9999, '2017-09-01', 92);
</code></pre>
</li>
</ul>
<h5 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h5><ul>
<li><p>查询所有学生信</p>
<pre class=" language-mysql"><code class="language-mysql">select * from tb_student;
</code></pre>
</li>
<li><p>查询所有课程名称及学分(投影和别名)</p>
<pre class=" language-mysql"><code class="language-mysql">select cname as 课程名称,credit as 学分 from tb_course;
</code></pre>
</li>
<li><p>查询所有女学生的姓名和出生日期(筛选)</p>
<pre class=" language-mysql"><code class="language-mysql">select sname as 姓名,birth as 出生日期 from tb_student where gender=0;
</code></pre>
</li>
<li><p>查询所有80后学生的姓名、性别和出生日期(筛选)</p>
<pre class=" language-mysql"><code class="language-mysql">判断
方法一(只适用于mysql数据库)：
select sname,if(gender, '男', '女'),birth from tb_student where birth between'1980-1-1' and '1989-12-31';
方法二(适用于所有数据库)：
select sname,case gender when 1 then '男' else '女' end,birth from tb_student where birth between'1980-1-1' and '1989-12-31';
</code></pre>
</li>
<li><p>查询姓”杨“的学生姓名和性别(模糊)</p>
<pre class=" language-mysql"><code class="language-mysql">select sname,gender from tb_student where sname like '杨%';
</code></pre>
</li>
<li><p>查询姓”杨“名字两个字的学生姓名和性别(模糊)</p>
<pre class=" language-mysql"><code class="language-mysql">select sname,gender from tb_student where sname like '杨_';
</code></pre>
</li>
<li><p>查询姓”杨“名字三个字的学生姓名和性别(模糊)</p>
<pre class=" language-mysql"><code class="language-mysql">select sname,gender from tb_student where sname like '杨__';
</code></pre>
</li>
<li><p>查询名字中有”不“字或“嫣”字的学生的姓名(模糊)</p>
<pre class=" language-mysql"><code class="language-mysql">select sname from tb_student where sname like '%不%' or sname like '%嫣%';
</code></pre>
</li>
<li><p>查询没有录入家庭住址的学生姓名(空值)</p>
<pre class=" language-mysql"><code class="language-mysql">select sname from tb_student where addr is null or addr='';
</code></pre>
</li>
<li><p>查询录入了家庭住址的学生姓名(空值)</p>
<pre class=" language-mysql"><code class="language-mysql">select sname from tb_student where addr is not null and addr<>'';
</code></pre>
</li>
<li><p>查询学生选课的所有日期(diatinct —– 去重)</p>
<pre class=" language-mysql"><code class="language-mysql">select distinct seldate from tb_score;
</code></pre>
</li>
<li><p>查询学生的家庭住址</p>
<pre class=" language-mysql"><code class="language-mysql">select distinct addr from tb_student where addr is not null and addr<>'';
</code></pre>
</li>
<li><p>查询学生的姓名和生日按年龄从大到小排列(排序)</p>
<pre class=" language-mysql"><code class="language-mysql">查询生日：
select sname,birth from tb_student order by birth asc;
查询年龄：
select sname,year(now()) - year(birth) as 年龄 from tb_student order by birth asc;
</code></pre>
</li>
<li><p>查询所有男学生的姓名和生日按年龄从大到小排列(排序)( order by ——- 排序)</p>
<pre class=" language-mysql"><code class="language-mysql">select sname,birth from tb_student where gender=1 order by birth asc;
</code></pre>
</li>
<li><p>查询年龄最大的学生的出生日期(聚合函数)</p>
<pre class=" language-mysql"><code class="language-mysql">select min(birth) from tb_student;
</code></pre>
</li>
<li><p>查询年龄最小的学生的出生日期(聚合函数)</p>
<pre class=" language-mysql"><code class="language-mysql">select max(birth) from tb_student;
</code></pre>
</li>
<li><p>查询男女学生的人数(分组和聚合函数)( 分组——— group by)</p>
<pre class=" language-mysql"><code class="language-mysql">按人数排降序：
select if(gender, '男', '女') as 性别, count(gender) as 人数 from tb_student group by gender order by 人数 desc;
</code></pre>
</li>
<li><p>查询课程编号为1111的课程的平均成绩(筛选和聚合函数)</p>
<pre class=" language-mysql"><code class="language-mysql">select avg(mark) as 平均分 from tb_score where cid=1111;
</code></pre>
</li>
<li><p>查询学号为1001的学生所有课程的总成绩(筛选和聚合函数)</p>
<pre class=" language-mysql"><code class="language-mysql">select sum(mark) as 平均分 from tb_score where cid=1001;
</code></pre>
</li>
<li><p>查询每个学生的学号和平均成绩(分组和聚合函数)</p>
<pre class=" language-mysql"><code class="language-mysql">select sid,avg(mark) from tb_score where mark is not null group by sid;
</code></pre>
</li>
<li><p>查询平均成绩大于等于90分的学生的学号和平均成绩(先分组，再筛选 ——— 分组后跟having)</p>
<pre class=" language-mysql"><code class="language-mysql">select sid,avgmark from tb_score group by sid having avg(mark)>=90;
</code></pre>
</li>
<li><p>查询年龄最大的学生的姓名(子查询)</p>
<ul>
<li><p>子查询 — 在一个查询中又使用到了另外一个查询的结果</p>
</li>
<li><p>查询年龄最大的学生的姓名（子查询）</p>
<pre class=" language-mysql"><code class="language-mysql">select sname from tb_student where birth= (select min(birth) from tb_student);
</code></pre>
</li>
</ul>
</li>
<li><p>查询年龄最大的学生的姓名和年龄</p>
<pre class=" language-mysql"><code class="language-mysql">select sname as 姓名, year(now()) - year(birth) as 年龄
from tb_student where birth= (select min(birth) from tb_student); 
</code></pre>
</li>
<li><p>查询选了两门以上的课程的学生姓名(子查询/分组条件/集合运算)</p>
<pre class=" language-mysql"><code class="language-mysql">select sname from tb_student where stuid in (
select sid from tb_score group by sid having count(sid)>2);
</code></pre>
</li>
<li><p>查询选课学生的姓名和平均成绩(子查询和连接查询)</p>
<pre class=" language-mysql"><code class="language-mysql">select sname, avgmark from tb_student t1,
(select sid, avg(mark) as avgmark from tb_score group by sid) t2
where stuid=sid;

select sname,cname,mark from tb_student
inner join tb_score on stuid=sid
inner join tb_course on couid=cid
where mark is not null;
-- 注意：在连接查询时结果没有给出连接条件就会形成笛卡尔积

-- 笛卡儿积
-- A(a, b, c)*B(d, e)={ad, ae,bd, be, cd, ce}

-- 查询学生姓名、所选课程名称和成绩(连接查询)
-- 连接查询(连接查询/连结查询)
select sname,cname,mark
from tb_score, tb_student, tb_course
where stuid=sid and couid=cid and mark is not null;

-- 查询每个学生的姓名和选课数量（左外连接和子查询）
-- 左外连接(left outer join) ----- 把左表（写在连接前面的表）不满足连接条件的记录也查询出来对应记录补null值
-- 右外连接(right outer join) ----- 把右表（写在连接后面的表）不满足连接条件的记录也查询出来对应记录补null值
-- 全外连接(full outer join) ------ 把满足和不满足条件的记录全部查出来，mysql数据库不支持此操作
select sname as 姓名, conter as 选课数量 from tb_student left join,
(select sid, count(sid) as conter from tb_score group by sid)t2
on stuid(+)=sid;

</code></pre>
</li>
</ul>
<h3 id="表的连接关系"><a href="#表的连接关系" class="headerlink" title="表的连接关系"></a>表的连接关系</h3><p><img src="/2018/10/16/数据库/practice/表连接1.png" alt="表连接1"></p>
<h4 id="内连接的方式"><a href="#内连接的方式" class="headerlink" title="内连接的方式"></a>内连接的方式</h4><p><img src="/2018/10/16/数据库/practice/表连接2.png" alt="表连接2"></p>
<h4 id="自连接的方式"><a href="#自连接的方式" class="headerlink" title="自连接的方式"></a>自连接的方式</h4><p><img src="/2018/10/16/数据库/practice/表连接3.png" alt="表连接3"></p>
<h4 id="外连接的方式"><a href="#外连接的方式" class="headerlink" title="外连接的方式"></a>外连接的方式</h4><p><img src="/2018/10/16/数据库/practice/表连接4.png" alt="表连接4"></p>
<h2 id="practice2"><a href="#practice2" class="headerlink" title="practice2"></a>practice2</h2><ul>
<li><p>创建人力资源管理系统数据库</p>
<pre class=" language-mysql"><code class="language-mysql">drop database if exists HRS;
create database HRS default charset utf8 collate utf8_bin;
</code></pre>
</li>
<li><p>切换数据库上下文环境<br><code>use HRS;</code></p>
</li>
<li><p>删除表</p>
<pre class=" language-mysql"><code class="language-mysql">drop table if exists TbEmp;
drop table if exists TbDept;
</code></pre>
</li>
<li><p>创建部门表</p>
<pre class=" language-mysql"><code class="language-mysql">create table TbDept
(
dno tinyint not null comment '部门编号',
dname varchar(10) not null comment '部门名称',
dloc varchar(20) not null comment '部门所在地',
primary key (dno)
);
</code></pre>
</li>
<li><p>添加部门记录</p>
<pre class=" language-mysql"><code class="language-mysql">insert into TbDept values (10, '会计部', '北京');
insert into TbDept values (20, '研发部', '成都');
insert into TbDept values (30, '销售部', '重庆');
insert into TbDept values (40, '运维部', '深圳');
</code></pre>
</li>
<li><p>创建员工表</p>
<pre class=" language-mysql"><code class="language-mysql">create table TbEmp
(
eno int not null comment '员工编号',
ename varchar(20) not null comment '员工姓名',
job varchar(20) not null comment '员工职位',
mgr int comment '主管编号',
sal int not null comment '月薪',
comm int comment '月补贴',
dno tinyint comment '所在部门编号',
primary key (eno)
);
</code></pre>
</li>
<li><p>添加外键约束</p>
<pre class=" language-mysql"><code class="language-mysql">alter table TbEmp add constraint fk_dno foreign key (dno) references TbDept(dno) on delete set null on update cascade;
-- 更新，删除后赋值为null，所以前面创建的时候就不能添加（is not null)
-- on delete set null on update cascade;
</code></pre>
</li>
<li><p>添加员工记录</p>
<pre class=" language-mysql"><code class="language-mysql">insert into TbEmp values 
(7800, '张三丰', '总裁', null, 9000, 1200, 20),
(2056, '乔峰', '分析师', 7800, 5000, 1500, 20),
(3088, '李莫愁', '设计师', 2056, 3500, 800, 20),
(3211, '张无忌', '程序员', 2056, 3200, null, 20),
(3233, '丘处机', '程序员', 2056, 3400, null, 20),
(3251, '张翠山', '程序员', 2056, 4000, null, 20),
(5566, '宋远桥', '会计师', 7800, 4000, 1000, 10),
(5234, '郭靖', '出纳', 5566, 2000, null, 10),
(3344, '黄蓉', '销售主管', 7800, 3000, 800, 30),
(1359, '胡一刀', '销售员', 3344, 1800, 200, 30),
(4466, '苗人凤', '销售员', 3344, 2500, null, 30),
(3244, '欧阳锋', '程序员', 3088, 3200, null, 20),
(3577, '杨过', '会计', 5566, 2200, null, 10),
(3588, '朱九真', '会计', 5566, 2500, null, 10);
</code></pre>
<h4 id="习题-1"><a href="#习题-1" class="headerlink" title="习题"></a>习题</h4></li>
<li><p>查询薪资最高的员工姓名和工资</p>
<pre class=" language-mysql"><code class="language-mysql">-- select ename, sal+comm from TbEmp order by sal desc limit 0, 1;        ------- 排序出现的问题：可能前几个人的工资一样
select ename as 总裁, sal as 工资 from tbemp
where sal=(select max(sal) from tbemp);
</code></pre>
</li>
<li><p>查询员工的姓名和年薪((月薪+补贴)*12)</p>
<pre class=" language-mysql"><code class="language-mysql">-- select ename as 姓名, sal12 + if(comm12,comm12,0) as 年薪 from TbEmp; or
select ename as 姓名, (sal + ifnull(comm,0))12 as 年薪 from TbEmp;
</code></pre>
</li>
<li><p>查询年薪大于5万的员工的姓名和年薪</p>
<pre class=" language-mysql"><code class="language-mysql">select ename as 姓名, (sal + ifnull(comm,0))12 as 年薪
-- from TbEmp where 年薪>50000;
from TbEmp where (sal + ifnull(comm,0))12>50000;
</code></pre>
</li>
<li><p>查询有员工的部门的编号和人数<br><code>select dno,count(dno) as 人数 from TbEmp group by dno;</code>.</p>
</li>
<li><p>查询所有部门的名称和人数</p>
</li>
</ul>
<pre class=" language-mysql"><code class="language-mysql">select dno as 部门编号,dname as 部门名称,counter as 人数 from tbdept as t1,
(select dno as d,count(dno) as counter from tbemp group by dno)t2
where t1.dno=t2.d;
</code></pre>
<pre class=" language-mysql"><code class="language-mysql">select dname as 部门名称, ifnull(total, 0) as 人数 from tbdept t1 left join
(select dno, count(dno) as total from tbemp group by dno)t2
on t1.dno=t2.dno;
</code></pre>
<ul>
<li><p>查询薪资最高的员工(Boss除外)的姓名和工资</p>
<pre class=" language-mysql"><code class="language-mysql">-- select ename as 姓名, sal+if(comm, comm, 0) as 工资 from TbEmp
-- order by (sal+if(comm, comm, 0)) desc limit 1, 1;
select ename as 员工, sal as 工资 from tbemp
where sal=(select max(sal) from tbemp where mgr is not null);
</code></pre>
</li>
<li><p>查询薪水超过平均薪水的员工的姓名和工资</p>
<pre class=" language-mysql"><code class="language-mysql">select ename as 姓名, sal as 工资 from tbemp
where (sal+if(comm, comm, 0))>(
select avg(sal+if(comm, comm, 0)) from tbemp);
</code></pre>
<pre class=" language-mysql"><code class="language-mysql">select ename as 姓名, sal as 工资 from TbEmp
where sal>(select avg(sal) from tbemp);
</code></pre>
</li>
<li><p>查询薪水超过其所在部门平均薪水的员工的姓名、部门编号和工资</p>
<pre class=" language-mysql"><code class="language-mysql">select ename, t1.dno, avgsal from tbemp t1,
(select dno, avg(sal) as avgsal from tbemp group by dno)t2
where t1.dno=t2.dno and sal>avgsal;
-- 多个连表条件之间用and连接
</code></pre>
</li>
<li><p>查询薪水超过其所在部门平均薪水的员工的姓名、部门名称和工资</p>
<pre class=" language-mysql"><code class="language-mysql">select ename, dname, sal from tbemp t1,
(select dno, avg(sal) as avgsal from tbemp group by dno)t2,
tbdept t3
where t1.dno=t2.dno and sal>avgsal and t2.dno=t3.dno;
</code></pre>
</li>
<li><p>查询部门中薪水最高的人姓名、工资和所在部门名称</p>
<pre class=" language-mysql"><code class="language-mysql">select ename, dname, sal from tbemp t1,
(select dno, max(sal) as maxsal from tbemp group by dno)t2,
tbdept t3
where t1.dno=t2.dno and t2.dno=t3.dno and sal=maxsal;
</code></pre>
</li>
<li><p>查询主管的姓名</p>
<pre class=" language-mysql"><code class="language-mysql">- -- select ename from tbemp where job like'%主管%';
select ename, job from tbemp
where eno in (select distinct mgr from tbemp where mgr is not null);

-- 说明：去重操作和集合运算效率是非常低的,可以使用以下方法
select ename as 主管, job as 职位 from tbemp t1 where exists 
(select 'x' from tbemp t2 where t1.eno=t2.mgr) order by eno desc;
</code></pre>
</li>
<li><p>通常建议用exists或者not exists操作来代替去重和集合运算</p>
<pre class=" language-mysql"><code class="language-mysql">select ename, job from tbemp t1
where exists (select 'x' from tbemp t2 where t1.eno=t2.mgr);
</code></pre>
</li>
<li><p>视图是查询的快照</p>
<pre class=" language-mysql"><code class="language-mysql">-- 创建视图
create view vw_dept_emp_count as
select dno, count(dno) from tbemp group by dno;
-- 查看视图
select * from vw_dept_emp_count;
-- 通过视图可以将用户对表的访问权限进一步加以限制
-- 也就是说普通用户看到的就是限制的视图内容
create view emp_no_sal as
select ename, dname, sal from tbemp t1,
(select dno, avg(sal) as avgsal from tbemp group by dno)t2,
tbdept t3
where t1.dno=t2.dno and sal>avgsal and t2.dno=t3.dno;
-- 查看视图,限制条件
select ename, dname from emp_no_sal;
</code></pre>
</li>
<li><p>用硬件做的事情，用软件也可以做；反之亦可</p>
</li>
<li><p>索引(相当于一本书的目录）</p>
<ul>
<li><p>为表创建索引可以加速查询(用空间换时间)</p>
</li>
<li><p>索引不能滥用：</p>
<ul>
<li><p>一、索引会让增删改变得更慢，应为增删改的操作可能会导致更新索引</p>
</li>
<li><p>二、索引会占用额外的存储空间</p>
</li>
<li>索引应该建在经常被用于查询的筛选条件的列上面，主键上有默认的索引(唯一索引)</li>
</ul>
</li>
</ul>
</li>
<li><p>创建索引</p>
<pre class=" language-mysql"><code class="language-mysql">-- 说明：使用模糊查询 ----- 如果查询条件不以%开头，索引有效;反之,无效
create index idx_emp_ename on tbemp(ename);
-- 唯一索引
create unique index uni_emp_ename on tbemp(ename);
</code></pre>
</li>
<li><p>删除索引<br><code>alter table tbemp drop index uni_emp_ename;</code></p>
</li>
</ul>

            </div>
            <hr/>

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">转载请注明: </span>
                    <a href="http://yoursite.com" class="b-link-green">微笑看你</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2018/10/16/数据库/practice/" class="b-link-green">practice</a>
                </p>
            </div>
        </div>
    </div>

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">上一篇</div>
            <div class="card">
                <a href="/2018/10/16/python/基础语法/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/14.jpg" class="responsive-img" alt="基础语法">
                        
                        <span class="card-title">基础语法</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">###（一）基础1.快捷键： control+/      注释/取消注释 control+s      保存（养成习惯） control+c      复制、拷贝 control+v      粘贴 control+x      剪切 c</div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2018-10-16
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-user fa-fw"></i>
                            smile
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/python/" target="_blank">
                        <span class="chip bg-color">python</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">下一篇</div>
            <div class="card">
                <a href="/2018/10/16/数据库/MySQL/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/2.jpg" class="responsive-img" alt="MySQL">
                        
                        <span class="card-title">MySQL</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">MySQL是一种开放源代码的关系型数据库管理系统（RDBMS），MySQL数据库系统使用最常用的数据库管理语言–结构化查询语言（SQL）进行数据库管理。
端口是IP地址区分不同服务的

Docker —- 屏蔽硬件和软件的差异
虚拟机（Vi</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2018-10-16
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-user fa-fw"></i>
                            smile
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/虚拟机ER外键集合函数/" target="_blank">
                        <span class="chip bg-color">虚拟机	ER	外键	集合函数</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>
    

</main>

<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            本站由&copy;<a href="https://blinkfox.github.io/" target="_blank">Blinkfox</a>基于
            <a href="https://hexo.io/zh-cn/" target="_blank">Hexo</a> 采用
            <a href="https://github.com/JackChenSmile/hexo-theme-matery" target="_blank">hexo-theme-matery</a>的主题搭建.
        </div>
        <div class="col s12 m4 l4 social-link">
            <a href="https://github.com/JackChenSmile" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
                <i class="fa fa-github fa-lg"></i>
            </a>
            <a href="mailto:JackChenSmile@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
                <i class="fa fa-envelope fa-lg"></i>
            </a>
            <a href="#!" class="tooltipped" data-tooltip="QQ联系我: 1963298993" data-position="top" data-delay="50">
                <i class="fa fa-qq fa-lg"></i>
            </a>
        </div>
    </div>
</footer>

<div class="progress-bar"></div>

<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title">搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input" autofocus="">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/js/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>
</body>
</html>