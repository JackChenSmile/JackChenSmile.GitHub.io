<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="微笑看你">
    <meta name="description" content="VBA语言的基础认识
第一节：标识符
一、定义

标识符是一种标识变量、常量、过程、函数、类等语言构成单位的符号，利用它可以完成对变量、常量、过程、函数、类等引用。



二、命名规则

（1）字母打头，由字母、数字和下划线组成，如A987">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>微笑看你</title>
    <link rel="icon" type="image/png" href="/medias/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">微笑看你</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>友情链接</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">微笑看你</div>
        <div class="logo-desc">
            
            To be or not to be,this is a question.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                友情链接
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/JackChenSmile/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/JackChenSmile/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>





<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/0.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-05-21
                </div>

                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <pre><code>VBA语言的基础认识
第一节：标识符
一、定义

标识符是一种标识变量、常量、过程、函数、类等语言构成单位的符号，利用它可以完成对变量、常量、过程、函数、类等引用。



二、命名规则

（1）字母打头，由字母、数字和下划线组成，如A987b_23Abc



（2）字符长度小于40，（Excel2002以上中文版本等，可以用汉字且长度可达254个字符）



（3）不能与VB保留字重名，如public，private，dim，goto，next，with，integer，single等



第二节：运算符
定义：运算符是代表VB某种运算功能的符号。

（1）赋值运算符  =

（2）数学运算符 &amp;、+ (字符连接符)、+(加)、-（减）、Mod（取余）、\（整除）、*（乘）、/
（除）、-（负号）、^（指数）

（3）逻辑运算符Not（非）、And（与）、Or(或)、Xor(异或)、Eqv(相等)、Imp(隐含)

（4）关系运算符 = （相同）、&lt;&gt;（不等）、&gt;（大于）、&lt;（小于）、&gt;=（不小于）、&lt;=（不大于）、
Like、Is

（5）位运算符  Not（逻辑非）、And（逻辑与）、Or（逻辑或）、Xor（逻辑异或）、Eqv（逻辑
等）、Imp（隐含）

第三节：数据类型
VBA共有12种数据类型，具体见下表，此外用户还可以根据以下类型用Type自定义数据类型。

VBA数据类型
第四节：变量与常量
（1）VBA允许使用未定义的变量，默认是变体变量

（2）在模块通用说明部分，加入Option Explicit语句可以强迫用户进行变量定义

（3）变量定义语句及变量作用域

一般变量作用域的原则是，那部分定义就在那部分起作用，模块中定义则在该模块那作用。

（4）常量为变量的一种特例，用Const定义，且定义时赋值，程序中不能改变值，作用域也如同变量作用域。如下定义：Const Pi=3.1415926 as single

第五节：数组
数组是包含相同数据类型的一组变量的集合，对数组中的单个变量引用通过数组索引下标进行。在内存中表现为一个连续的内存块，必须用Global或Dim语句来定义。定义规则如下：

Dim 数组名([lower to ]upper [, [lower to ]upper, ….]) as type ;Lower缺省值为0。二
维数组是按行列排列，如XYZ(行，列)。

除了以上固定数组外，VBA 还有一种功能强大的动态数组，定义时无大小维数声明；在程序中再利用Redim语句来重新改变数组大小，原来数组内容可以通过加preserve关键字来保留。

如下例：
Dim array1() as double : Redim array1(5) : array1(3)=250 : Redim preserve array1(5,10)

第六节：注释和赋值语句
（1）注释语句是用来说明程序中某些语句的功能和作用；VBA中有两种方法标识为注释语句。

√单引号 ’  ;如：’定义全局变量；可以位于别的语句之尾，也可单独一行

√Rem ;如：Rem定义全局变量；只能单独一行

（2）赋值语句是进行对变量或对象属性赋值的语句，采用赋值号 =，如X=123：Form1.caption=”
我的窗口”

对对象的赋值采用：set myobject=object 或  myobject:=object

第七节：书写规范
（1）VBA不区分标识符的字母大小写，一律认为是小写字母；

（2）一行可以书写多条语句，各语句之间以冒号 :  分开；

（3）一条语句可以多行书写，以空格加下划线 _  来标识下行为续行；

（4）标识符最好能简洁明了，不造成歧义。

第八节：判断语句
（1）If…Then…Else语句

If condition Then [statements][Else elsestatements]

如1：If A&gt;B And C&lt;D Then A=B+2 Else  A=C+2
如2：If x&gt;250 Then  x=x-100

或者，可以使用块形式的语法：

If condition Then
[statements]
[ElseIf condition-n Then
[elseifstatements] ...
[Else
[elsestatements]]
End If

如1:
If Number &lt; 10  Then
     Digits = 1
ElseIf Number &lt; 100  Then
     Digits = 2
Else
     Digits = 3
End If

（2）Select Case…Case…End Case语句

如1：
Select Case  Pid
   Case  “A101”
   Price=200
   Case  “A102”
   Price=300
   ……
   Case Else
   Price=900
End Case

（3）Choose 函数
choose(index, choce-1,choice-2,…,choice-n)，可以用来选择自变量串列中的一个值，并将其返回，index 必要参数，数值表达式或字段，它的运算结果是一个数值，且界于 1 和可选择的项目数之间。choice 必要参数，Variant表达式，包含可选择项目的其中之一。如：GetChoice = Choose(Ind, &quot;Speedy&quot;, &quot;United&quot;, &quot;Federal&quot;)

（4）Switch函数
Switch(expr-1, value-1[, expr-2, value-2 _ [, expr-n,value-n]])switch 函数和 Choose 函数类似，但它是以两个一组的方式返回所要的值，在串列中，最先为
TRUE 的值会被返回。 expr 必要参数，要加以计算的 Variant 表达式。value 必要参数。如果相关的表达式为 True，则返回此部分的数值或表达式，没有一个表达式为 True，Switch 会返回一个 Null值。

第九节：循环语句
（1）For Next语句  以指定次数来重复执行一组语句

For counter = start To end [Step step]                  ＇step 缺省值为1
[statements]
[Exit For]
[statements]
Next [counter]

如1：
For Words = 10 To 1 Step  -1                               ＇建立 10 次循环 
      For Chars = 0 To 9                                        ＇建立 10 次循环
           MyString = MyString &amp; Chars                      ＇将数字添加到字符串中
      Next Chars                                                   ＇Increment counter
      MyString = MyString &amp; &quot; &quot;                                ＇添加一个空格
Next  Words

（2）For Each…Next 语句  主要功能是对一个数组或集合对象进行，让所有元素重复执行一次语句

For Each element In  group
Statements
[Exit for]
Statements
Next  [element]

如1：
For Each rang2 In  range1
     With range2.interior
             .colorindex=6
             .pattern=xlSolid
     End with
Next

这上面一例中用到了 With…End With  语句，目的是省去对象多次调用，加快速度；

语法为：
With object
[statements]
End With

（3）Do…loop语句 在条件为true时，重复执行区块命令

Do {while |until} condition&#39; while 为当型循环，until为直到型循环，顾名思义，不多说啦
Statements
Exit do
Statements
Loop

或者使用下面语法：
Do                                    &#39; 先do 再判断，即不论如何先干一次再说
Statements
Exit do
Statements
Loop {while |until} condition

第十节 其他类语句和错误语句处理
一．其他循环语句
结构化程序使用以上判断和循环语句已经足够，建议不要轻易使用下面的语句，虽然 VBA 还支持。

（1）Goto line 该语句为跳转到line语句行

（2） On expression gosub destinatioinlist 或者 on expression goto destinationlist 语句为根据 exprssion表达式值来跳转到所要的行号或行标记

（3）Gosub line…line…Return语句，  Return 返回到 Gosub line行，如下例：

Sub gosubtry()
      Dim num
      Num=inputbox(“输入一个数字，此值将会被判断循环”)
      If num&gt;0 then Gosub Routine1 ：Debug.print num：Exit  sub
      Routine1:
      Num=num/5
      Return
End sub

（4）while…wend语句，只要条件为TRUE，循环就执行，这是以前VB老语法保留下来的，如下

例：
while condition      ‘while I&lt;50
[statements]        ‘I=I+1
wend                  ‘Wend

二．错误语句处理
执行阶段有时会有错误的情况发生，利用OnError语句来处理错误，启动一个错误的处理程序。
语法如下：

On Error Goto Line        ‘当错误发生时，会立刻转移到line行去
On Error Resume Next    ‘当错误发生时，会立刻转移到发生错误的下一行去
On Erro Goto 0             ‘当错误发生时，会立刻停止过程中任何错误处理过程

第十一节 过程和函数
过程是构成程序的一个模块，往往用来完成一个相对独立的功能。过程可以使程序更清晰、更具结构性。VBA具有四种过程：Sub 过程、Function函数、Property属性过程和Event事件过程。

一．Sub过程
Sub 过程的参数有两种传递方式：按值传递(ByVal)和按地址传递(ByRef)。如下例：

Sub password (ByVal x as integer, ByRef y as integer)
      If y=100 then y=x+y else y=x-y
      x=x+100
End sub
Sub call_password ()
      Dim x1 as integer
      Dim y1 as integer
      x1=12
      y1=100
      Callpassword(x1,y1)     ‘调用过程方式：1.Call   过程名(参数1,  参数2…);2.  过程名 参数1, 参数2…
      debug.print x1,y1         ‘结果是12、112，y1按地址传递改变了值，而x1按值传递，未改变原值
End sub

二．Function函数
函数实际是实现一种映射，它通过一定的映射规则，完成运算并返回结果。参数传递也两种：按值传递(ByVal)和按地址传递(ByRef)。如下例：

Function password(ByVal x as integer, byref y as integer) as boolean
       If y=100 then y=x+y else y=x-y
       x=x+100
       if y=150 then password=true else password=false
End Function
Sub call_password ()
      Dim x1 as integer
      Dim y1 as integer
      x1=12
      y1=100
      if password then ‘调用函数：1. 作为一个表达式放在=右端 ; 2. 作为参数使用
      debug.print x1
      end if
End sub

三．Property属性过程和Event事件过程
这是VB在对象功能上添加的两个过程，与对象特征密切相关，也是VBA比较重要组成，技术比较复杂，可以参考相关书籍。

第十二节内部函数
在VBA程序语言中有许多内置函数，可以帮助程序代码设计和减少代码的编写工作。

一．测试函数
IsNumeric(x)          ‘是否为数字,  返回Boolean结果，True  or False      
IsDate(x)              ‘是否是日期,  返回Boolean结果，True  or False
IsEmpty（x）         ‘是否为Empty, 返回Boolean结果，True  or False
IsArray(x)             ‘指出变量是否为一个数组。
IsError(expression)  ‘指出表达式是否为一个错误值
IsNull(expression)    ‘指出表达式是否不包含任何有效数据 (Null)。
IsObject(identifier)  ‘指出标识符是否表示对象变量

二．数学函数
Sin(X)、Cos(X)、Tan(X)、Atan(x)  三角函数，单位为弧度
Log(x) 返回x的自然对数
Exp(x)返回 
Abs(x) 返回绝对值
Int(number)、Fix(number) 都返回参数的整数部分，区别：Int 将 -8.4 转换成 -9，而 Fix 将
-8.4 转换成 -8
Sgn(number) 返回一个 Variant (Integer)，指出参数的正负号
Sqr(number) 返回一个 Double，指定参数的平方根
VarType(varname) 返回一个 Integer，指出变量的子类型
Rnd（x）返回0-1之间的单精度数据，x为随机种子

三．字符串函数
Trim(string)                       去掉string左右两端空白
Ltrim(string)                      去掉string左端空白
Rtrim(string)                      去掉string右端空白
Len(string)                        计算string长度
Left(string, x)                    取string左段x个字符组成的字符串
Right(string, x)                   取string右段x个字符组成的字符串
Mid(string, start,x)              取string从start位开始的x个字符组成的字符串
Ucase(string)                     转换为大写
Lcase(string)                      转换为小写
Space(x)                           返回x个空白的字符串
Asc(string)                         返回一个 integer，代表字符串中首字母的字符代码
Chr(charcode)                     返回 string,其中包含有与指定的字符代码相关的字符

四．转换函数
CBool(expression)                   转换为Boolean型
CByte(expression)                  转换为Byte型
CCur(expression)                    转换为Currency型
CDate(expression)                  转换为Date型
CDbl(expression)                    转换为Double型
CDec(expression)                   转换为Decemal型
CInt(expression)                    转换为Integer型
CLng(expression)                   转换为Long型
CSng(expression)                   转换为Single型
CStr(expression)                    转换为String型
CVar(expression)                    转换为Variant型
Val(string)                             转换为数据型
Str(number)                           转换为String

五．时间函数
Now            返回一个 Variant (Date)，根据计算机系统设置的日期和时间来指定日期和时间。

Date           返回包含系统日期的 Variant (Date)。

Time           返回一个指明当前系统时间的 Variant (Date)。

Timer          返回一个 Single，代表从午夜开始到现在经过的秒数。

TimeSerial(hour, minute, second) 返回一个 Variant (Date)，包含具有具体时、分、秒的时间。

DateDiff(interval, date1, date2[, firstdayofweek[, firstweekofyear]]) 返回 Variant(Long) 的值，表示两个指定日期间的时间间隔数目

Second(time) 返回一个 Variant (Integer)，其值为 0 到 59 之间的整数，表示一分钟之中的某个秒

Minute(time) 返回一个 Variant (Integer)，其值为 0 到 59 之间的整数，表示一小时中的某分钟

Hour(time)  返回一个 Variant(Integer)，其值为 0 到 23 之间的整数，表示一天之中的某一钟点

Day(date)   返回一个 Variant(Integer)，其值为 1 到 31 之间的整数，表示一个月中的某一日

Month(date) 返回一个 Variant(Integer)，其值为 1 到 12 之间的整数，表示一年中的某月

Year(date)  返回 Variant (Integer)，包含表示年份的整数。

Weekday(date, [firstdayofweek]) 返回一个 Variant (Integer)，包含一个整数，代表某个日期是星期几

第十三节 文件操作
文件
Dir[(pathname[,attributes])] ；pathname 可选参数，用来指定文件名的字符串表达式，可能包含目录或文件夹、以及驱动器。如果没有找到  pathname，则会返回零长度字符串 (&quot;&quot;);

attributes 可选参数。常数或数值表达式，其总和用来指定文件属性。如果省略，则会返回匹配 pathname 但不包含属性的文件。

删除
Kill pathname   从磁盘中删除文件, pathname 参数是用来指定一个文件名

RmDir pathname  从磁盘中删除目录，pathname 参数是用来指定一个文件夹
打开

Open pathname For mode [Access access] [lock] As [#]filenumber [Len=reclength] 能够对文件输入/输出 (I/O)。

pathname 必要。字符串表达式，指定文件名，该文件名可能还包括目录、文件夹及驱动器。

mode 必要。关键字，指定文件方式，有 Append、Binary、Input、Output、或 Random 方式。如果未指定方式，则以 Random 访问方式打开文件。

access 可选。关键字，说明打开的文件可以进行的操作，有 Read、Write、或 ReadWrite 操作。

lock 可选。关键字，说明限定于其它进程打开的文件的操作，有 Shared、LockRead、LockWrite、和 Lock Read Write 操作。

filenumber 必要。一个有效的文件号，范围在 1 到 511 之间。使用 FreeFile 函数可得到下一个可用的文件号。 reclength 可选。小于或等于 32，767（字节）的一个数。对于用随机访问方式打开的文件，该值就是记录长度。对于顺序文件，该值就是缓冲字符数。

说明 对文件做任何 I/O 操作之前都必须先打开文件。Open  语句分配一个缓冲区供文件进行I/O 之用，并决定缓冲区所使用的访问方式。如果 pathname 指定的文件不存在，那么，在用Append、Binary、Output、或 Random 方式打开文件时，可以建立这一文件。如果文件已由其它进程打开，而且不允许指定的访问类型，则 Open 操作失败，而且会有错误发生。如果 mode是 Binary 方式，则 Len 子句会被忽略掉。

重要 在 Binary、Input 和 Random 方式下可以用不同的文件号打开同一文件，而不必先将该文件关闭。在 Append 和 Output 方式下，如果要用不同的文件号打开同一文件，则必须在打开文件之前先关闭该文件。

读入
Input #filenumber, varlist 从已打开的顺序文件中读出数据并将数据指定给变量
Get [#]filenumber, [recnumber], varname将一个已打开的磁盘文件读入一个变量之中。

写入
Write #filenumber, [outputlist] 将数据写入顺序文件
Print #filenumber, [outputlist] 将格式化显示的数据写入顺序文件中
Put [#]filenumber, [recnumber], varname 将一个变量的数据写入磁盘文件中。

关闭
Close [filenumberlist] 关闭 Open 语句所打开的输入/输出 (I/O) 文件
注意 如果今后想用 Input # 语句读出文件的数据，就要用 Write # 语句而不用 Print # 语句将数据写入文件。因为在使用 Write# 时，将数据域分界就可确保每个数据域的完整性，因此可用 Input# 再将数据读出来。使用 Write#  还能确保任何地区的数据都被正确读出。Write与 Print # 语句不同，当要将数据写入文件时，Write # 语句会在项目和用来标记字符串的引号之间插入逗号。Write # 语句在将 outputlist 中的最后一个字符写入文件后会插入一个新行字符，即回车换行符，(Chr(13) + Chr(10))。

其他文件函数
LOF(filenumber)  返回一个 Long，表示用 Open 语句打开的文件的大小，该大小以字节为单
位。

EOF(filenumber)  返回一个 Integer，它包含 Boolean 值 True，表明已经到达为 Random 或
顺序 Input 打开的文件的结尾。

Loc(filenumber)   返回一个 Long，在已打开的文件中指定当前读/写位置

Seek(filenumber)  返回一个 Long，在 Open 语句打开的文件中指定当前的读/写位





IF 多条件判断返回值

　　IF(logical_test, [value_if_true], [value_if_false])

　　示例：　小于500，且未到期的，返回“补款”

　　IF(AND(A2&lt;500,B2=&quot;未到期&quot;),&quot;补款&quot;,&quot;&quot;)

　　职称为工程师或高工的，返回“满足”

　　IF(OR(C3=&quot;工程师&quot;, C3=&quot;高工&quot;),&quot;满足&quot;,&quot;&quot;)

　　说明：两个条件同时成立用AND,任一个成立用OR函数。



IFS 多场景判断返回值

IFS(logical_test1,value_if_true1, logical_test2, value_if_true2, ...)

示例：

在一列中，根据不同的判断条件，给出符合条件的值





IFERROR 把公式产生的错误值显示为自定义值

IFERROR(value, value_if_error)  第一个参数为需要判断的计算式，第二个参数为当第一个参数出错时要返回的值。

　　示例：成绩低于60，不及格　　

IFERROR(A2&gt;=60,&quot;不及格&quot;)



COUNTIF 单条件计数

　　COUNTIF(range, criteria)

　　示例：统计E列工资大于6000的人员数

　　COUNTIF(E:E, &quot;&gt;6000&quot;)

　　COUNTIF(E:E, &quot;&gt;&quot;&amp;M9) 假设M9单元格内容为6000



COUNTIFS 多条件计数

　　COUNTIFS(criteria_range1, criteria1, criteria_range2, criteria2, ...)

　　示例：统计属于销售部门，工资大于6000的员工人数

　　COUNTIFS(D:D, &quot;销售&quot;, E:E, &quot;&gt;6000&quot;)



SUMIF 按条件在查找区域进行查找，并返回查找区域对应的数据区域中数值的和

　　SUMIF(range, criteria, [sum_range])

　　示例：当不指定SUM_RANGE时，将直接对RANGE区域求和

　　SUMIF(C:C, &quot;&gt;1000&quot;), 对大于1000的单元格求和

　　SUMIF(B:B, &quot;果汁&quot;, C:C), 对B列为果汁对应的C列销量求和



SUMIFS 多条件组合的数据求和

　　SUMIFS(sum_range, criteria_range1, criteria1, criteria_range2, criteria2, ...)

　　示例： 统计生产部门，男性工资的总和

　　SUMIFS(K:K, D:D, &quot;生产&quot;, C:C, &quot;男&quot;)　　



AVERAGEIF, AVERAGEIFS和SUMIF, SUMIFS类似



VLOOKUP, HLOOKUP 搜索用户查找范围中首列（或首行）中满足条件的数据，并根据指定的列号（行号）返回对应的值。VLOOKUP对列数据按行进行查找，HLOOKUP对行数据按列查找

　　VLOOKUP(lookup_value, table_array, col_index_num, [range_lookup])

　　HLOOKUP(lookup_value, table_array, row_index_num, [range_lookup])

　　[range_lookup]默认值为1或TRUE，使用模糊匹配方式进行查找。如果设置成0或FALSE，使用精确查找，同时支持无序查找。

　　示例：查找员工号为2267的员工姓名

　　VLOOKUP(&quot;2267&quot;, A1:D4, 2)





LEN 返回文本串的字符个数

　　LEN(text)



SUBSTITUTE 将目标文本中指定的字符串替换为新的字符串

　　SUBSTITUTE(text, old_text, new_text, instance_num)

　　示例：

　　将第二个狐替换成虎

　　SUBSTITUTE(&quot;狐假狐威&quot;, &quot;狐&quot;, &quot;虎&quot;, 2)

　　计算单元格中MANUAL字符的个数

(LEN(J13)-LEN(SUBSTITUTE(J13,&quot;MANUAL&quot;,)))/LEN(&quot;MANUAL&quot;)

　　



INDEX 根据给定的一个范围（区域引用或数组）中指定的行号和列号来返回一个值，如果源数据是区域，则返回单元格引用；如果源范围是数组，则返回数组中的某个值。

　　INDEX(reference, row_num, [column_num], [area_num])

　　INDEX(array, row_num, [column_num])

　　示例：从左侧的数据表隔行提取，生成新的工作表

　　E4：INDEX($C$3:$C$8, ROW(A2)*2-1)

　　F4：INDEX($C$3:$C$8,ROW(A2)*2)





SMALL 取指定的第N小的值

　　SMALL(array, K)

 　　示例：

　　取第一小的值

　　SMALL({10，15，20},1.5)等同于SMALLSMALL({10，15，20},1)，结果为10



LARGE 取指定的第N大的值，与SMALL相反
</code></pre>
            </div>
            <hr/>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;转载请注明:
                    </span>
                    <a href="http://yoursite.com" class="b-link-green">微笑看你</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2021/05/21/通信技术/VBA语法/" class="b-link-green"></a>
                </p>
            </div>
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-dot-circle-o"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2021/05/21/通信技术/VBA语法/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="">
                        
                        <span class="card-title"></span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">VBA语言的基础认识
第一节：标识符
一、定义

标识符是一种标识变量、常量、过程、函数、类等语言构成单位的符号，利用它可以完成对变量、常量、过程、函数、类等引用。



二、命名规则

（1）字母打头，由字母、数字和下划线组成，如A987</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2021-05-21
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-user fa-fw"></i>
                            smile
                            
                        </span>
                    </div>
                </div>

                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/12/31/批量修改文件名称/批量修改文件名称/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="">
                        
                        <span class="card-title"></span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">文件名称修改import os
from re import split
import shutil


# 提取文件名称
ym = 'C:/Users/Administrator/Desktop/源文件'
path = 'C:/Users</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2020-12-31
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-user fa-fw"></i>
                            smile
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            本站由&copy;<a href="https://JackChenSmile.github.io/" target="_blank">Blinkfox</a>基于
            <a href="https://hexo.io/" target="_blank">Hexo</a> 的
            <a href="https://github.com/JackChenSmile/hexo-theme-matery" target="_blank">hexo-theme-matery</a>主题搭建.

            

            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                </span>
                <a href="https://beian.miit.gov.cn/#/Integrated/index" target="ICP"><p>蜀ICP备18037612号</p></a>
                # <p>蜀ICP备18037612号</p>
                
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:xxx@xx.xx" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=123123123" class="tooltipped" data-tooltip="QQ联系我: 123123123" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>


</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->



    <script src="/libs/others/clicklove.js"></script>


    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


</body>
</html>